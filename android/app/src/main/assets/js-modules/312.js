__d(function(e,t,n,r){Object.defineProperty(r,"__esModule",{value:!0});var i=t(47),s=babelHelpers.interopRequireDefault(i),o=t(313),a=babelHelpers.interopRequireDefault(o),l=t(12),p=t(314),u=babelHelpers.interopRequireDefault(p),d=t(317),c=babelHelpers.interopRequireDefault(d),f=t(305),_=babelHelpers.interopRequireDefault(f),h=t(306),g=babelHelpers.interopRequireDefault(h),v=t(330),b=babelHelpers.interopRequireDefault(v),m=t(331),P=babelHelpers.interopRequireDefault(m),y=t(335),R=babelHelpers.interopRequireDefault(y),S=t(337),k=babelHelpers.interopRequireWildcard(S),D=function(){},H=l.Easing.inOut(l.Easing.ease),x=500,E=.5,I=20,V=25,T=135,C=function(e){e.__isNative&&0===Object.keys(e._listeners).length&&e.addListener(D)},M=function(e){function t(){var e,n,r,i;babelHelpers.classCallCheck(this,t);for(var o=arguments.length,a=Array(o),l=0;l<o;l++)a[l]=arguments[l];return n=r=babelHelpers.possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r._gestureStartValue=0,r._isResponding=!1,r._immediateIndex=null,r._screenDetails={},r._childEventSubscribers={},r._isRouteFocused=function(e){var t=r.props.transitionProps.navigation.state,n=t.routes[t.index];return e===n},r._getScreenDetails=function(e){var t=r.props,n=t.screenProps,i=t.transitionProps.navigation,s=t.router,o=r._screenDetails[e.key];if(!o||o.state!==e.route){r._childEventSubscribers[e.route.key]||(r._childEventSubscribers[e.route.key]=(0,b.default)(i.addListener,e.route.key));var a=(0,g.default)({dispatch:i.dispatch,state:e.route,isFocused:function(){return r._isRouteFocused(e.route)},addListener:r._childEventSubscribers[e.route.key]});o={state:e.route,navigation:a,options:s.getScreenOptions(a,n)},r._screenDetails[e.key]=o}return o},r._getTransitionConfig=function(){var e="modal"===r.props.mode;return R.default.getTransitionConfig(r.props.transitionConfig,r.props.transitionProps,r.props.prevTransitionProps,e)},r._renderCard=function(e){var t=r._getTransitionConfig(),n=t.screenInterpolator,i=n&&n(babelHelpers.extends({},r.props.transitionProps,{scene:e})),o=r.props.router.getComponentForRouteName(e.route.routeName),a=r.props,l=a.transitionProps,p=babelHelpers.objectWithoutProperties(a,["transitionProps"]);return s.default.createElement(u.default,babelHelpers.extends({},p,l,{key:"card_"+e.key,style:[i,r.props.cardStyle],scene:e}),r._renderInnerScene(o,e))},i=n,babelHelpers.possibleConstructorReturn(r,i)}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.screenProps!==this.props.screenProps&&(this._screenDetails={}),e.transitionProps.scenes.forEach(function(e){t._screenDetails[e.key]&&t._screenDetails[e.key].state!==e.route&&(t._screenDetails[e.key]=null)})}},{key:"componentDidUpdate",value:function(){var e=this,t=this.props.transitionProps.navigation.state.routes.map(function(e){return e.key});Object.keys(this._childEventSubscribers).forEach(function(n){t.includes(n)||delete e._childEventSubscribers[n]})}},{key:"_renderHeader",value:function(e,t){var n=this._getScreenDetails(e).options.header;if("undefined"!=typeof n&&"function"!=typeof n)return n;var r=n||function(e){return s.default.createElement(c.default,e)},i=this._getTransitionConfig(),o=i.headerLeftInterpolator,a=i.headerTitleInterpolator,l=i.headerRightInterpolator,p=this.props,u=(p.mode,p.transitionProps),d=(p.prevTransitionProps,babelHelpers.objectWithoutProperties(p,["mode","transitionProps","prevTransitionProps"]));return r(babelHelpers.extends({},d,u,{scene:e,mode:t,transitionPreset:this._getHeaderTransitionPreset(),getScreenDetails:this._getScreenDetails,leftInterpolator:o,titleInterpolator:a,rightInterpolator:l}))}},{key:"_animatedSubscribe",value:function(e){C(e.transitionProps.layout.width),C(e.transitionProps.layout.height),C(e.transitionProps.position)}},{key:"_reset",value:function(e,t){"ios"===l.Platform.OS&&k.supportsImprovedSpringAnimation()?l.Animated.spring(this.props.transitionProps.position,{toValue:e,stiffness:5e3,damping:600,mass:3,useNativeDriver:this.props.transitionProps.position.__isNative}).start():l.Animated.timing(this.props.transitionProps.position,{toValue:e,duration:t,easing:H,useNativeDriver:this.props.transitionProps.position.__isNative}).start()}},{key:"_goBack",value:function(e,t){var n=this,r=this.props.transitionProps,i=r.navigation,s=r.position,o=r.scenes,a=Math.max(e-1,0);this._immediateIndex=a;var p=function(){n._immediateIndex=null;var e=o.find(function(e){return e.index===a+1});!n._isResponding&&e&&i.dispatch(_.default.back({key:e.route.key,immediate:!0}))};"ios"===l.Platform.OS&&k.supportsImprovedSpringAnimation()?l.Animated.spring(s,{toValue:a,stiffness:5e3,damping:600,mass:3,useNativeDriver:s.__isNative}).start(p):l.Animated.timing(s,{toValue:a,duration:t,easing:H,useNativeDriver:s.__isNative}).start(p)}},{key:"render",value:function(){var e=this,t=null,n=this._getHeaderMode();"float"===n&&(t=this._renderHeader(this.props.transitionProps.scene,n));var r=this.props,i=r.transitionProps,o=i.navigation,p=i.position,u=i.layout,d=i.scene,c=i.scenes,f=r.mode,_=o.state.index,h="modal"===f,g=this._getScreenDetails(d),v=g.options,b="inverted"===v.gestureDirection,m="boolean"==typeof v.gesturesEnabled?v.gesturesEnabled:"ios"===l.Platform.OS,P=m?l.PanResponder.create({onPanResponderTerminate:function(){e._isResponding=!1,e._reset(_,0)},onPanResponderGrant:function(){p.stopAnimation(function(t){e._isResponding=!0,e._gestureStartValue=t})},onMoveShouldSetPanResponder:function(t,n){if(_!==d.index)return!1;var r=null==e._immediateIndex?_:e._immediateIndex,i=n[h?"dy":"dx"],s=t.nativeEvent[h?"pageY":"pageX"],o=h?u.height.__getValue():u.width.__getValue(),a=!!o,l=b?o-(s-i):s-i,p=e._getScreenDetails(d).options.gestureResponseDistance,c=void 0===p?{}:p,f=h?c.vertical||T:c.horizontal||V;if(l>f)return!1;var g=Math.abs(i)>I,v=0===r,m=g&&a&&!v;return m},onPanResponderMove:function(t,n){var r=e._gestureStartValue,i=h?"dy":"dx",s=h?u.height.__getValue():u.width.__getValue(),o=(l.I18nManager.isRTL&&"dx"===i)!==b?r+n[i]/s:r-n[i]/s,d=(0,a.default)(_-1,o,_);p.setValue(d)},onPanResponderTerminationRequest:function(){return!1},onPanResponderRelease:function(t,n){if(e._isResponding){e._isResponding=!1;var r=null==e._immediateIndex?_:e._immediateIndex,i=h?u.height.__getValue():u.width.__getValue(),s=b?-1:1,o=s*n[h?"dy":"dx"],a=s*n[h?"vy":"vx"],l=i/x,d=Math.max(Math.abs(a),l),c=b?(i-o)/d:o/d,f=b?o/d:(i-o)/d;p.stopAnimation(function(t){return a<-.5?void e._reset(r,c):a>.5?void e._goBack(r,f):void(t<=_-E?e._goBack(r,f):e._reset(r,c))})}}}):null,y=m?P.panHandlers:{},R=[O.container,this._getTransitionConfig().containerStyle];return s.default.createElement(l.View,babelHelpers.extends({},y,{style:R}),s.default.createElement(l.View,{style:O.scenes},c.map(function(t){return e._renderCard(t)})),t)}},{key:"_getHeaderMode",value:function(){return this.props.headerMode?this.props.headerMode:"android"===l.Platform.OS||"modal"===this.props.mode?"screen":"float"}},{key:"_getHeaderTransitionPreset",value:function(){return"android"===l.Platform.OS||"screen"===this._getHeaderMode()?"fade-in-place":this.props.headerTransitionPreset?this.props.headerTransitionPreset:"fade-in-place"}},{key:"_renderInnerScene",value:function(e,t){var n=this._getScreenDetails(t),r=n.navigation,i=this.props.screenProps,o=this._getHeaderMode();return"screen"===o?s.default.createElement(l.View,{style:O.container},s.default.createElement(l.View,{style:{flex:1}},s.default.createElement(P.default,{screenProps:i,navigation:r,component:e})),this._renderHeader(t,o)):s.default.createElement(P.default,{screenProps:this.props.screenProps,navigation:r,component:e})}}]),t}(s.default.Component),O=l.StyleSheet.create({container:{flex:1,flexDirection:"column-reverse"},scenes:{flex:1}});r.default=M},312);